// This is a Prisma schema file
// Learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  email               String                   @id @map("email")
  eightUserId         String                   @map("eight_user_id")
  eightAccessToken    String                   @map("eight_access_token")
  eightRefreshToken   String                   @map("eight_refresh_token")
  eightTokenExpiresAt DateTime                 @map("eight_token_expires_at")
  createdAt           DateTime                 @default(now()) @map("created_at")
  updatedAt           DateTime                 @updatedAt @map("updated_at")
  temperatureProfile  UserTemperatureProfile?

  @@map("8slp_users")
}

model UserTemperatureProfile {
  email              String   @id @map("email")
  bedTime            String   @map("bed_time") // Store as string like HH:MM:SS.ssssss
  wakeupTime         String   @map("wakeup_time") // Store as string like HH:MM:SS.ssssss
  initialSleepLevel  Int      @map("initial_sleep_level")
  midStageSleepLevel Int      @map("mid_stage_sleep_level")
  finalSleepLevel    Int      @map("final_sleep_level")
  timezoneTZ         String   @map("timezone_tz")
  // Partner profile fields (optional for backward compatibility)
  partnerBedTime            String?  @map("partner_bed_time")
  partnerWakeupTime         String?  @map("partner_wakeup_time")
  partnerInitialSleepLevel  Int?     @map("partner_initial_sleep_level")
  partnerMidStageSleepLevel Int?     @map("partner_mid_stage_sleep_level")
  partnerFinalSleepLevel    Int?     @map("partner_final_sleep_level")
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")
  user               User     @relation(fields: [email], references: [email])

  @@map("8slp_user_temperature_profiles")
} 